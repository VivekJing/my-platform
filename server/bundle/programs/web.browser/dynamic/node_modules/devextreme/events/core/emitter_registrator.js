function module(t,e,i){"use strict";var n=t("../../core/renderer"),r=t("../../core/utils/ready_callbacks"),a=t("../../core/dom_adapter"),s=t("../../events/core/events_engine"),c=t("../../core/element_data"),o=t("../../core/class"),l=t("../../core/utils/extend").extend,d=t("../../core/utils/array").inArray,h=t("../../core/utils/iterator").each,u=t("./event_registrator"),_=t("../utils"),p=t("../pointer"),m=t("./wheel"),f="dxEventManager",v="dxEmitter",E,b=new(o.inherit({ctor:function(){this._attachHandlers(),this.reset(),this._proxiedCancelHandler=this._cancelHandler.bind(this),this._proxiedAcceptHandler=this._acceptHandler.bind(this)},_attachHandlers:function(){r.add(function(){var t=a.getDocument();s.subscribeGlobal(t,_.addNamespace(p.down,f),this._pointerDownHandler.bind(this)),s.subscribeGlobal(t,_.addNamespace(p.move,f),this._pointerMoveHandler.bind(this)),s.subscribeGlobal(t,_.addNamespace([p.up,p.cancel].join(" "),f),this._pointerUpHandler.bind(this)),s.subscribeGlobal(t,_.addNamespace(m.name,f),this._mouseWheelHandler.bind(this))}.bind(this))},_eachEmitter:function(t){for(var e=this._activeEmitters||[],i=0;e.length>i;){var n=e[i];if(!1===t(n))break;e[i]===n&&i++}},_applyToEmitters:function(t,e){this._eachEmitter((function(i){i[t].call(i,e)}))},reset:function(){this._eachEmitter(this._proxiedCancelHandler),this._activeEmitters=[]},resetEmitter:function(t){this._proxiedCancelHandler(t)},_pointerDownHandler:function(t){_.isMouseEvent(t)&&t.which>1||this._updateEmitters(t)},_updateEmitters:function(t){this._isSetChanged(t)&&(this._cleanEmitters(t),this._fetchEmitters(t))},_isSetChanged:function(t){var e=this._closestEmitter(t),i=this._emittersSet||[],n=e.length!==i.length;return h(e,(function(t,e){return!(n=n||i[t]!==e)})),this._emittersSet=e,n},_closestEmitter:function(t){var e=this,i=[],r=n(t.target);function a(n,r){r&&r.validatePointers(t)&&r.validate(t)&&(r.addCancelCallback(e._proxiedCancelHandler),r.addAcceptCallback(e._proxiedAcceptHandler),i.push(r))}for(;r.length;){var s=c.data(r.get(0),"dxEmitter")||[];h(s,a),r=r.parent()}return i},_acceptHandler:function(t,e){var i=this;this._eachEmitter((function(n){n!==t&&i._cancelEmitter(n,e)}))},_cancelHandler:function(t,e){this._cancelEmitter(t,e)},_cancelEmitter:function(t,e){var i=this._activeEmitters;e?t.cancel(e):t.reset(),t.removeCancelCallback(),t.removeAcceptCallback();var n=d(t,i);n>-1&&i.splice(n,1)},_cleanEmitters:function(t){this._applyToEmitters("end",t),this.reset(t)},_fetchEmitters:function(t){this._activeEmitters=this._emittersSet.slice(),this._applyToEmitters("start",t)},_pointerMoveHandler:function(t){this._applyToEmitters("move",t)},_pointerUpHandler:function(t){this._updateEmitters(t)},_mouseWheelHandler:function(t){this._allowInterruptionByMouseWheel()&&(t.pointers=[null],this._pointerDownHandler(t),this._adjustWheelEvent(t),this._pointerMoveHandler(t),t.pointers=[],this._pointerUpHandler(t))},_allowInterruptionByMouseWheel:function(){var t=!0;return this._eachEmitter((function(e){return t=e.allowInterruptionByMouseWheel()&&t})),t},_adjustWheelEvent:function(t){var e=null;if(this._eachEmitter((function(i){if(i.gesture){var n=i.getDirection(t);return"horizontal"!==n&&!t.shiftKey||"vertical"!==n&&t.shiftKey?(e=i,!1):void 0}})),e){var i=e.getDirection(t),n="both"===i&&!t.shiftKey||"vertical"===i,r;t[n?"pageY":"pageX"]+=t.delta}},isActive:function(t){var e=!1;return this._eachEmitter((function(i){e=e||i.getElement().is(t)})),e}})),H="dxEmitterSubscription",g=function(t){var e=t.emitter,i=t.events[0],n=t.events;h(n,(function(r,a){u(a,{noBubble:!t.bubble,setup:function(t){var n=c.data(t,"dxEmitterSubscription")||{},r=c.data(t,"dxEmitter")||{},s=r[i]||new e(t);n[a]=!0,r[i]=s,c.data(t,"dxEmitter",r),c.data(t,"dxEmitterSubscription",n)},add:function(t,e){var n,r;c.data(t,"dxEmitter")[i].configure(l({delegateSelector:e.selector},e.data),e.type)},teardown:function(t){var e=c.data(t,"dxEmitterSubscription"),r=c.data(t,"dxEmitter"),s=r[i];delete e[a];var o=!0;h(n,(function(t,i){return o=o&&!e[i]})),o&&(b.isActive(t)&&b.resetEmitter(s),s&&s.dispose(),delete r[i])}})}))};i.exports=g}

