function module(t,e,i){"use strict";var s=t("../../core/renderer"),n=t("../../core/utils/window").getWindow(),o=t("../list"),a=t("./ui.date_box.strategy"),u=t("../themes"),d=t("../../core/utils/common").noop,r=t("../../core/utils/type").isDate,h=t("../../core/utils/extend").extend,l=t("./ui.date_utils"),c=t("../../localization/date"),p={min:new Date(0,0,0,0,0),max:new Date(0,0,0,23,59)},_=a.inherit({NAME:"List",supportedKeys:function(){return{tab:function(){this.option("opened")&&this.close()},space:d,home:d,end:d}},getDefaultOptions:function(){return h(this.callBase(),{applyValueMode:"instantly"})},getDisplayFormat:function(t){return t||"shorttime"},popupConfig:function(t){var e=h(t,{width:this._getPopupWidth()});return u.isAndroid5()&&h(!0,e,{position:{offset:{h:-16,v:-10}}}),e},useCurrentDateByDefault:function(){return!0},_getPopupWidth:function(){var t=this.dateBox.$element().outerWidth();return u.isAndroid5()&&(t+=32),t},popupShowingHandler:function(){this._dimensionChanged()},_renderWidget:function(){this.callBase(),this._refreshItems()},_getWidgetName:function(){return o},_getWidgetOptions:function(){var t=this.dateBox._keyboardProcessor;return{_keyboardProcessor:t?t.attachChildProcessor():null,itemTemplate:this._timeListItemTemplate.bind(this),onItemClick:this._listItemClickHandler.bind(this),tabIndex:-1,onFocusedItemChanged:this._refreshActiveDescendant.bind(this),selectionMode:"single"}},_refreshActiveDescendant:function(t){this.dateBox.setAria("activedescendant",""),this.dateBox.setAria("activedescendant",t.actionValue)},_refreshItems:function(){this._widgetItems=this._getTimeListItems(),this._widget.option("items",this._widgetItems)},renderOpenedState:function(){this._widget&&(this._widget.option("focusedElement",null),this._setSelectedItemsByValue(),this._widget.option("templatesRenderAsynchronously")?this._asyncScrollTimeout=setTimeout(this._scrollToSelectedItem.bind(this)):this._scrollToSelectedItem())},dispose:function(){this.callBase(),clearTimeout(this._asyncScrollTimeout)},_updateValue:function(){this._widget&&(this._refreshItems(),this._setSelectedItemsByValue(),this._scrollToSelectedItem())},_setSelectedItemsByValue:function(){var t=this.dateBoxValue(),e=this._getDateIndex(t);-1===e?this._widget.option("selectedItems",[]):this._widget.option("selectedIndex",e)},_scrollToSelectedItem:function(){this._widget.scrollToItem(this._widget.option("selectedIndex"))},_getDateIndex:function(t){for(var e=-1,i=0,s=this._widgetItems.length;i<s;i++)if(this._areDatesEqual(t,this._widgetItems[i])){e=i;break}return e},_areDatesEqual:function(t,e){return r(t)&&r(e)&&t.getHours()===e.getHours()&&t.getMinutes()===e.getMinutes()},_getTimeListItems:function(){var t=this.dateBox.dateOption("min")||this._getBoundaryDate("min"),e=this.dateBox.dateOption("max")||this._getBoundaryDate("max"),i=this.dateBox.dateOption("value")||null,s=e-t,n=t.getMinutes()%this.dateBox.option("interval");return s<0?[]:(s>l.ONE_DAY&&(s=l.ONE_DAY),i-t<l.ONE_DAY?this._getRangeItems(t,new Date(t),s):((t=this._getBoundaryDate("min")).setMinutes(n),i&&Math.abs(i-e)<l.ONE_DAY&&(s=(60*e.getHours()+Math.abs(e.getMinutes()-n))*l.ONE_MINUTE),this._getRangeItems(t,new Date(t),s)))},_getRangeItems:function(t,e,i){for(var s=[],n=this.dateBox.option("interval");e-t<=i;)s.push(new Date(e)),e.setMinutes(e.getMinutes()+n);return s},_getBoundaryDate:function(t){var e=p[t],i=this.dateBox.dateOption("value")||new Date;return new Date(i.getFullYear(),i.getMonth(),i.getDate(),e.getHours(),e.getMinutes())},_timeListItemTemplate:function(t){var e=this.dateBox.option("displayFormat");return c.format(t,this.getDisplayFormat(e))},_listItemClickHandler:function(t){this.dateBox.option("opened",!1);var e=this.dateBox.option("value"),i=t.itemData,s=i.getHours(),n=i.getMinutes(),o=i.getSeconds(),a=i.getFullYear(),u=i.getMonth(),d=i.getDate();e?((e=new Date(e)).setHours(s),e.setMinutes(n),e.setSeconds(o),e.setFullYear(a),e.setMonth(u),e.setDate(d)):e=new Date(a,u,d,s,n,0,0),this.dateBoxValue(e)},attachKeyboardEvents:function(t){var e=t.attachChildProcessor();this._widget&&this._widget.option("_keyboardProcessor",e)},_dimensionChanged:function(){this._getPopup()&&this._updatePopupDimensions()},_updatePopupDimensions:function(){this._updatePopupWidth(),this._updatePopupHeight()},_updatePopupWidth:function(){this.dateBox._setPopupOption("width",this._getPopupWidth())},_updatePopupHeight:function(){this.dateBox._setPopupOption("height","auto");var t=this._widget.$element().outerHeight(),e=.45*s(n).height();this.dateBox._setPopupOption("height",Math.min(t,e)),this.dateBox._timeList&&this.dateBox._timeList.updateDimensions()}});i.exports=_}

