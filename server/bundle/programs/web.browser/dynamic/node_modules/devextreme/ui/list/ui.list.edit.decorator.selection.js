function module(e){"use strict";var t=e("../../core/renderer"),l=e("../../events/core/events_engine"),s=e("../../events/click"),i=e("../../core/utils/extend").extend,n=e("../widget/ui.errors"),c=e("../check_box"),o=e("../radio_group/radio_button"),a=e("../../events/utils"),d=e("./ui.list.edit.decorator_registry").register,h=e("./ui.list.edit.decorator"),_="dx-list-select-decorator-enabled",r="dx-list-select-all",u="dx-list-select-all-checkbox",p="dx-list-select-all-label",A="dx-list-select-checkbox-container",C="dx-list-select-checkbox",f="dx-list-select-radiobutton-container",v="dx-list-select-radiobutton",x="dx-state-focused",g=a.addNamespace(s.name,"dxListEditDecorator");d("selection","default",h.inherit({_init:function(){this.callBase.apply(this,arguments);var e=this._list.option("selectionMode");this._singleStrategy="single"===e,this._containerClass=this._singleStrategy?f:A,this._controlClass=this._singleStrategy?v:C,this._controlWidget=this._singleStrategy?o:c,this._list.$element().addClass(_)},beforeBag:function(e){var l=e.$itemElement,s=e.$container,n=t("<div>").addClass(this._controlClass);new this._controlWidget(n,i(this._commonOptions(),{value:this._isSelected(l),focusStateEnabled:!1,hoverStateEnabled:!1,onValueChanged:function(e){this._processCheckedState(l,e.value),e.event&&e.event.stopPropagation()}.bind(this)})),s.addClass(this._containerClass),s.append(n)},modifyElement:function(e){this.callBase.apply(this,arguments);var t=e.$itemElement,s=this._controlWidget.getInstance(t.find("."+this._controlClass));l.on(t,"stateChanged",function(e,t){s.option("value",t)}.bind(this))},_updateSelectAllState:function(){this._$selectAll&&this._selectAllCheckBox.option("value",this._list.isSelectAll())},afterRender:function(){"all"===this._list.option("selectionMode")&&(this._$selectAll?this._updateSelectAllState():this._renderSelectAll())},handleKeyboardEvents:function(e,t){return this._$selectAll&&this._needMoveFocus(e,t)?(this._list.option("focusedElement",void 0),this._selectAllCheckBox.$element().addClass("dx-state-focused"),!0):(this._$selectAll&&this._selectAllCheckBox.$element().removeClass("dx-state-focused"),this._list.focusListItem(e),!1)},_needMoveFocus:function(e,t){return!t&&(0===e||e===this._list._getLastItemIndex())},handleEnterPressing:function(){if(this._$selectAll&&this._selectAllCheckBox.$element().hasClass("dx-state-focused"))return this._selectAllCheckBox.option("value",!this._selectAllCheckBox.option("value")),!0},_renderSelectAll:function(){var e=this._$selectAll=t("<div>").addClass("dx-list-select-all");this._selectAllCheckBox=this._list._createComponent(t("<div>").addClass("dx-list-select-all-checkbox").appendTo(e),c),t("<div>").addClass("dx-list-select-all-label").text(this._list.option("selectAllText")).appendTo(e),this._list.itemsContainer().prepend(e),this._updateSelectAllState(),this._attachSelectAllHandler()},_attachSelectAllHandler:function(){this._selectAllCheckBox.option("onValueChanged",this._selectAllHandler.bind(this)),l.off(this._$selectAll,g),l.on(this._$selectAll,g,this._selectAllClickHandler.bind(this))},_selectAllHandler:function(e){e.event&&e.event.stopPropagation();var t=this._selectAllCheckBox.option("value"),l;!1!==this._list._createActionByOption("onSelectAllValueChanged")({value:t})&&(!0===t?this._selectAllItems():!1===t&&this._unselectAllItems())},_checkSelectAllCapability:function(){var e=this._list,t=e.getDataSource();return!!("allPages"!==e.option("selectAllMode")||!e.option("grouped")||t&&t.group())||(n.log("W1010"),!1)},_selectAllItems:function(){this._checkSelectAllCapability()&&this._list._selection.selectAll("page"===this._list.option("selectAllMode"))},_unselectAllItems:function(){this._checkSelectAllCapability()&&this._list._selection.deselectAll("page"===this._list.option("selectAllMode"))},_selectAllClickHandler:function(){this._selectAllCheckBox.option("value",!this._selectAllCheckBox.option("value"))},_isSelected:function(e){return this._list.isItemSelected(e)},_processCheckedState:function(e,t){t?this._list.selectItem(e):this._list.unselectItem(e)},dispose:function(){this._disposeSelectAll(),this._list.$element().removeClass(_),this.callBase.apply(this,arguments)},_disposeSelectAll:function(){this._$selectAll&&(this._$selectAll.remove(),this._$selectAll=null)}}))}

