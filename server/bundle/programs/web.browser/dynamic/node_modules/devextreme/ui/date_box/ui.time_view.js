function module(t,e,i){"use strict";var o=t("../../core/renderer"),n=t("../editor/editor"),s=t("../number_box"),a=t("../select_box"),r=t("../box"),u=t("../../core/utils/extend").extend,h=t("../../core/component_registrator"),l=t("../../localization/date"),d=t("./ui.date_utils"),_="dx-timeview",m="dx-timeview-clock",c="dx-timeview-field",p="dx-timeview-hourarrow",v="dx-timeview-time-separator",f="dx-timeview-format12",x=-1,g=1,w="dx-timeview-minutearrow",B=function(t,e,i){C(t,e,i)},C=function(t,e,i){t.css("transform","rotate("+e+"deg) translate(0,"+i+"px)")},b=n.inherit({_getDefaultOptions:function(){return u(this.callBase(),{value:new Date(Date.now()),use24HourFormat:!0,_showClock:!0,_arrowOffset:0,stylingMode:void 0})},_defaultOptionsRules:function(){return this.callBase().concat([{device:{platform:"android"},options:{_arrowOffset:15}},{device:{platform:"generic"},options:{_arrowOffset:5}}])},_getValue:function(){return this.option("value")||new Date},_init:function(){this.callBase(),this.$element().addClass("dx-timeview")},_render:function(){this.callBase(),this._renderBox(),this._updateTime()},_renderBox:function(){var t=o("<div>").appendTo(this.$element()),e=[];this.option("_showClock")&&e.push({ratio:1,shrink:0,baseSize:"auto",template:this._renderClock.bind(this)}),e.push({ratio:0,shrink:0,baseSize:50,template:this._renderField.bind(this)}),this._createComponent(t,r,{height:"100%",width:"100%",direction:"col",items:e})},_renderClock:function(t,e,i){this._$hourArrow=o("<div>").addClass("dx-timeview-hourarrow"),this._$minuteArrow=o("<div>").addClass("dx-timeview-minutearrow");var n=o(i);n.addClass("dx-timeview-clock").append(this._$hourArrow).append(this._$minuteArrow),this.setAria("role","presentation",n)},_updateClock:function(){var t=this._getValue(),e=t.getHours()/12*360+t.getMinutes()/60*30,i=t.getMinutes()/60*360;B(this._$hourArrow,e,this.option("_arrowOffset")),B(this._$minuteArrow,i,this.option("_arrowOffset"))},_getBoxItems:function(t){var e=[{ratio:0,shrink:0,baseSize:"auto",template:function(){return this._hourBox.$element()}.bind(this)},{ratio:0,shrink:0,baseSize:"auto",template:o("<div>").addClass("dx-timeview-time-separator").text(l.getTimeSeparator())},{ratio:0,shrink:0,baseSize:"auto",template:function(){return this._minuteBox.$element()}.bind(this)}];return t&&e.push({ratio:0,shrink:0,baseSize:"auto",template:function(){return this._format12.$element()}.bind(this)}),e},_renderField:function(){var t=!this.option("use24HourFormat");return this._createHourBox(),this._createMinuteBox(),t&&this._createFormat12Box(),this._createComponent(o("<div>").addClass("dx-timeview-field"),r,{direction:"row",align:"center",crossAlign:"center",items:this._getBoxItems(t)}).$element()},_createHourBox:function(){this._hourBox=this._createComponent(o("<div>"),s,u({min:-1,max:24,value:this._getValue().getHours(),onValueChanged:this._onHourBoxValueChanged.bind(this)},this._getNumberBoxConfig())),this._hourBox.setAria("label","hours")},_isPM:function(){return!this.option("use24HourFormat")&&1===this._format12.option("value")},_onHourBoxValueChanged:function(t){var e=this._getValue(),i=this._convertMaxHourToMin(t.value),o=new Date(e);this._isPM()&&(i+=12),o.setHours(i),d.normalizeTime(o),this.option("value",o)},_convertMaxHourToMin:function(t){var e=this.option("use24HourFormat")?24:12;return(e+t)%e},_createMinuteBox:function(){this._minuteBox=this._createComponent(o("<div>"),s,u({min:-1,max:60,value:this._getValue().getMinutes(),onValueChanged:function(t){var e=(60+t.value)%60;this._minuteBox.option("value",e);var i=new Date(this._getValue());i.setMinutes(e),d.normalizeTime(i),this.option("value",i)}.bind(this)},this._getNumberBoxConfig())),this._minuteBox.setAria("label","minutes")},_createFormat12Box:function(){var t=l.getPeriodNames();this._format12=this._createComponent(o("<div>").addClass("dx-timeview-format12"),a,u({items:[{value:-1,text:t[0]},{value:1,text:t[1]}],valueExpr:"value",displayExpr:"text",onValueChanged:function(t){var e=this._getValue().getHours(),i=new Date(this._getValue()),o=(e+12*t.value)%24;i.setHours(o),this.option("value",i)}.bind(this),value:this._getValue().getHours()>=12?1:-1},{stylingMode:this.option("stylingMode")})),this._format12.setAria("label","type")},_refreshFormat12:function(){if(!this.option("use24HourFormat")){var t,e,i=this._getValue().getHours()>=12;this._format12._valueChangeActionSuppressed=!0,this._format12.option("value",i?1:-1),this._format12._valueChangeActionSuppressed=!1}},_getNumberBoxConfig:function(){return u({showSpinButtons:!0,disabled:this.option("disabled"),valueFormat:function(t){return(t<10?"0":"")+t}},{stylingMode:this.option("stylingMode")})},_normalizeHours:function(t){return this.option("use24HourFormat")?t:t%12||12},_updateField:function(){this._hourBox&&(this._hourBox._valueChangeActionSuppressed=!0,this._hourBox.option("value",this._normalizeHours(this._getValue().getHours())),this._hourBox._valueChangeActionSuppressed=!1),this._minuteBox&&(this._minuteBox._valueChangeActionSuppressed=!0,this._minuteBox.option("value",this._getValue().getMinutes()),this._minuteBox._valueChangeActionSuppressed=!1),this._refreshFormat12()},_updateTime:function(){this.option("_showClock")&&this._updateClock(),this._updateField()},_visibilityChanged:function(t){t&&this._updateTime()},_toggleDisabledState:function(t){this._hourBox&&this._hourBox.option("disabled",t),this._minuteBox&&this._minuteBox.option("disabled",t)},_optionChanged:function(t){switch(t.name){case"value":this._updateTime(),this.callBase(t);break;case"_arrowOffset":break;case"use24HourFormat":case"_showClock":case"stylingMode":this._invalidate();break;default:this.callBase(t)}}});h("dxTimeView",b),i.exports=b}

