function module(e,t,n){"use strict";var r=e("../core/renderer"),i=e("../core/dom_adapter"),a=e("../core/utils/window"),o=a.getWindow(),s=e("../core/utils/deferred").Deferred,u=e("./widget/ui.errors"),c=e("../core/utils/dom"),l,d=e("../core/utils/ready_callbacks").add,f=e("../core/utils/iterator").each,h=e("../core/devices"),m=e("../core/utils/view_port"),v=e("./themes_callback"),g=m.value,p=m.changeCallback,w="link[rel=dx-theme]",x="data-theme",y="data-active",b="dx-hairlines",k,C,W,_,T,E,I="dx.",D;function A(){if(!a.hasWindow())return null;var e,t=r("<div>",k).addClass("dx-theme-marker").appendTo(k.documentElement);try{return(e=t.css("fontFamily"))?(e=e.replace(/["']/g,"")).substr(0,I.length)!==I?null:e.substr(I.length):null}finally{t.remove()}}function F(e){var t;function n(){T=null,v.fire(),v.empty()}T=e,U()?n():(t=Date.now(),E=setInterval((function(){var e=U(),r=!e&&Date.now()-t>15e3;r&&u.log("W0004",T),(e||r)&&(clearInterval(E),E=void 0,n())}),10))}function U(){return!T||A()===T}function M(){var e=r(w,k);e.length&&(W={},C=r(c.createMarkupFromString("<link rel=stylesheet>"),k),e.each((function(){var e=r(this,k),t=e.attr(x),n=e.attr("href"),i="true"===e.attr(y);W[t]={url:n,isActive:i}})),e.last().after(C),e.remove())}function P(e){var t=e.split("."),n=null;if(W){if(e in W)return e;f(W,(function(e,r){var i=e.split(".");if(i[0]===t[0]&&!(t[1]&&t[1]!==i[1]||t[2]&&t[2]!==i[2]))return n&&!r.isActive||(n=e),!r.isActive&&void 0}))}return n}function R(e){try{e!==k&&(W=null)}catch(t){W=null}k=e}function j(e){R((e=e||{}).context||i.getDocument()),k&&(M(),_=void 0,G(e))}function G(e){if(!arguments.length)return _=_||A();S(g()),"string"==typeof(e=e||{})&&(e={theme:e});var t,n=e._autoInit,r=e.loadCallback;if(_=e.theme||_,n&&!_&&(_=H(h.current())),(_=P(_))&&(t=W[_]),r&&v.add(r),t)C.attr("href",W[_].url),!v.has()&&!e._forceTimeout||E?T&&(T=_):F(_);else{if(!n)throw u.Error("E0021",_);v.fire(),v.empty()}X(),N(m.originalViewPort(),_)}function H(e){var t=e.platform,n=e.version&&e.version[0];switch(t){case"ios":t+="7";break;case"android":t+="5";break;case"win":t+=n&&8===n?"8":"10"}return t}function L(e){var t=[],n=(e=e||G())&&e.split(".");return n&&(t.push("dx-theme-"+n[0],"dx-theme-"+n[0]+"-typography"),n.length>1&&t.push("dx-color-scheme-"+n[1]+(z(e)?"-"+n[2]:""))),t}function N(e,t){var n;D=L(t).join(" "),r(e).addClass(D),function(){var t=a.hasWindow()&&o.devicePixelRatio;if(t&&!(t<2)){var n=r("<div>");n.css("border",".5px solid transparent"),r("body").append(n),1===n.outerHeight()&&(r(e).addClass(b),D+=" "+b),n.remove()}}()}function S(e){r(e).removeClass(D)}function V(e){v.add(e)}function q(e,t){return t||(t=_||A()),new RegExp(e).test(t)}function z(e){return q("material",e)}function B(e){return q("android5",e)}function J(e){return q("ios7",e)}function K(e){return q("generic",e)}function O(e){return q("win8",e)}function Q(e){return q("win10",e)}function X(){O()&&u.log("W0010","The 'win8' theme","16.1","Use the 'generic' theme instead."),Q()&&u.log("W0010","The 'win10' theme","17.2","Use the 'generic' theme instead."),B()&&u.log("W0010","The 'android5' theme","18.1","Use the 'material' theme instead.")}var Y=new s;function Z(){if(j({_autoInit:!0,_forceTimeout:!0}),r(w,k).length)throw u.Error("E0022");Y.resolve()}a.hasWindow()?Z():d(Z),p.add((function(e,t){Y.done((function(){S(t),N(e)}))})),h.changed.add((function(){j({_autoInit:!0})})),t.current=G,t.ready=V,t.init=j,t.attachCssClasses=N,t.detachCssClasses=S,t.themeNameFromDevice=H,t.waitForThemeLoad=F,t.isMaterial=z,t.isAndroid5=B,t.isIos7=J,t.isGeneric=K,t.isWin8=O,t.isWin10=Q,t.resetTheme=function(){C&&C.attr("href","about:blank"),_=null,T=null},n.exports.default=n.exports}

