function module(r,e,t){"use strict";var i=function(){function r(r,e){var t=[],i=!0,o=!1,n=void 0;try{for(var a,u=r[Symbol.iterator]();!(i=(a=u.next()).done)&&(t.push(a.value),!e||t.length!==e);i=!0);}catch(c){o=!0,n=c}finally{try{!i&&u.return&&u.return()}finally{if(o)throw n}}return t}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=r("../core/utils/dependency_injector"),n=r("../core/utils/array").inArray,a=r("../core/utils/common").escapeRegExp,u=r("../core/utils/iterator").each,c=r("../core/utils/type").isPlainObject,s=r("./ldml/number"),p=r("../core/config"),f=r("../core/errors"),l=r("./utils").toFixed,m=4,d=10,g=["currency","fixedpoint","exponential","percent","decimal"],h,y={largenumber:"auto",thousands:1,millions:2,billions:3,trillions:4},b=o({numericFormats:g,defaultLargeNumberFormatPostfixes:{1:"K",2:"M",3:"B",4:"T"},_parseNumberFormatString:function(r){var e,t={};if(r&&"string"==typeof r)return e=r.toLowerCase().split(" "),u(e,(function(r,e){n(e,g)>-1?t.formatType=e:e in y&&(t.power=y[e])})),t.power&&!t.formatType&&(t.formatType="fixedpoint"),t.formatType?t:void 0},_calculateNumberPower:function(r,e,t,i){var o=Math.abs(r),n=0;if(o>1)for(;o&&o>=e&&(void 0===i||n<i);)n++,o/=e;else if(o>0&&o<1)for(;o<1&&(void 0===t||n>t);)n--,o*=e;return n},_getNumberByPower:function(r,e,t){for(var i=r;e>0;)i/=t,e--;for(;e<0;)i*=t,e++;return i},_formatNumber:function(r,e,t){var i,o;return"auto"===e.power&&(e.power=this._calculateNumberPower(r,1e3,0,4)),e.power&&(r=this._getNumberByPower(r,e.power,1e3)),i=this.defaultLargeNumberFormatPostfixes[e.power]||"",o=(o=this._formatNumberCore(r,e.formatType,t)).replace(/(\d|.$)(\D*)$/,"$1"+i+"$2")},_formatNumberExponential:function(r,e){var t,i=this._calculateNumberPower(r,10),o=this._getNumberByPower(r,i,10);return void 0===e.precision&&(e.precision=1),o.toFixed(e.precision||0)>=10&&(i++,o/=10),t=(i>=0?"+":"")+i.toString(),this._formatNumberCore(o,"fixedpoint",e)+"E"+t},_addZeroes:function(r,e){for(var t=Math.pow(10,e),i=r<0?"-":"",o=(r=(Math.abs(r)*t>>>0)/t).toString();o.length<e;)o="0"+o;return i+o},_addGroupSeparators:function(r){var e=r.toString().split(".");return e[0].replace(/\B(?=(\d{3})+(?!\d))/g,p().thousandsSeparator)+(e[1]?p().decimalSeparator+e[1]:"")},_formatNumberCore:function(r,e,t){return"exponential"===e?this._formatNumberExponential(r,t):("decimal"!==e&&null!==t.precision&&(t.precision=t.precision||0),"percent"===e&&(r*=100),void 0!==t.precision&&(r="decimal"===e?this._addZeroes(r,t.precision):null===t.precision?r.toPrecision():l(r,t.precision)),r="decimal"!==e?this._addGroupSeparators(r):r.toString().replace(".",p().decimalSeparator),"percent"===e&&(r+="%"),r)},_normalizeFormat:function(r){return r?"function"==typeof r?r:(c(r)||(r={type:r}),r):{}},_getSeparators:function(){return{decimalSeparator:this.getDecimalSeparator(),thousandsSeparator:this.getThousandsSeparator()}},getThousandsSeparator:function(){return this.format(1e4,"fixedPoint")[2]},getDecimalSeparator:function(){return this.format(1.2,{type:"fixedPoint",precision:1})[1]},convertDigits:function(r,e){var t=this.format(90,"decimal");if("string"!=typeof r||"0"===t[1])return r;var i=e?t[1]:"0",o=e?"0":t[1],n=e?t[0]:"9",a=new RegExp("["+i+"-"+n+"]","g");return r.replace(a,(function(r){return String.fromCharCode(r.charCodeAt(0)+(o.charCodeAt(0)-i.charCodeAt(0)))}))},getSign:function(r,e){if("-"===r.replace(/[^0-9-]/g,"").charAt(0))return-1;if(!e)return 1;var t=this._getSeparators(),i=new RegExp("[0-9"+a(t.decimalSeparator+t.thousandsSeparator)+"]+","g"),o=this.format(-1,e).replace(i,"1"),n;return r.replace(i,"1")===o?-1:1},format:function(r,e){if("number"!=typeof r)return r;if("number"==typeof e)return r;if("function"==typeof(e=e&&e.formatter||e))return e(r);(e=this._normalizeFormat(e)).type||(e.type="decimal");var t=this._parseNumberFormatString(e.type);return t?this._formatNumber(r,t,e):this.convertDigits(s.getFormatter(e.type,this._getSeparators())(r))},parse:function(r,e){if(r){if(e&&e.parser)return e.parser(r);r=this.convertDigits(r,!0),e&&"string"!=typeof e&&f.log("W0011");var t=this.getDecimalSeparator(),i=new RegExp("[^0-9"+a(t)+"]","g"),o=r.replace(i,"").replace(t,".").replace(/\.$/g,""),n;return"."===o||""===o?null:this._calcSignificantDigits(o)>15?NaN:+o*this.getSign(r,e)}},_calcSignificantDigits:function(r){var e=r.split("."),t=i(e,2),o=t[0],n=t[1],a=function(r){for(var e=-1,t=0;t<r.length;t++)if("0"!==r[t]){e=t;break}return e>-1?r.length-e:0},u=0;return o&&(u+=a(o.split(""))),n&&(u+=a(n.split("").reverse())),u}});t.exports=b}

