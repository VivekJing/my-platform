function module(t,e,i){"use strict";var n=t("../../core/renderer"),o=t("../../events/core/events_engine"),s=t("../../core/utils/support"),a=t("../../core/utils/browser"),l=t("../../core/utils/common"),r=t("../../core/utils/type"),c=t("../../core/utils/extend").extend,d=t("../../core/utils/dom").getPublicElement,u=t("../../core/utils/window"),h=u.getNavigator(),p=t("../../core/dom_adapter"),f=t("../../core/devices"),_=t("../../core/component_registrator"),b=t("../../core/dom_component"),v=t("../widget/selectors"),m=t("../../events/utils"),g=t("./ui.events.emitter.gesture.scroll"),S=t("./ui.scrollable.simulated"),y=t("./ui.scrollable.native"),w=t("../../core/utils/deferred").when,D="dxScrollable",$="dxScrollableStrategy",x="dx-scrollable",C="dx-scrollable-disabled",k="dx-scrollable-container",B="dx-scrollable-wrapper",N="dx-scrollable-content",T="dx-scrollable-customizable-scrollbars",O="vertical",E="horizontal",P="both",z=function(){return[{device:function(){return!s.nativeScrolling},options:{useNative:!1}},{device:function(t){return!f.isSimulator()&&"generic"===f.real().platform&&"generic"===t.platform},options:{bounceEnabled:!1,scrollByThumb:!0,scrollByContent:s.touch,showScrollbar:"onHover"}}]},H=b.inherit({_getDefaultOptions:function(){return c(this.callBase(),{disabled:!1,onScroll:null,direction:O,showScrollbar:"onScroll",useNative:!0,bounceEnabled:!0,scrollByContent:!0,scrollByThumb:!1,onUpdated:null,onStart:null,onEnd:null,onBounce:null,onStop:null,useSimulatedScrollbar:!1,useKeyboard:!0,inertiaEnabled:!0,pushBackValue:0,updateManually:!1})},_defaultOptionsRules:function(){return this.callBase().concat(z(),[{device:function(){return s.nativeScrolling&&"android"===f.real().platform&&!a.mozilla},options:{useSimulatedScrollbar:!0}},{device:function(){return"ios"===f.real().platform},options:{pushBackValue:1}}])},_initOptions:function(t){this.callBase(t),"useSimulatedScrollbar"in t||this._setUseSimulatedScrollbar()},_setUseSimulatedScrollbar:function(){this.initialOption("useSimulatedScrollbar")||this.option("useSimulatedScrollbar",!this.option("useNative"))},_init:function(){this.callBase(),this._initScrollableMarkup(),this._locked=!1},_visibilityChanged:function(t){t?(this.update(),this._updateRtlPosition(),this._savedScrollOffset&&this.scrollTo(this._savedScrollOffset),delete this._savedScrollOffset):this._savedScrollOffset=this.scrollOffset()},_initScrollableMarkup:function(){var t=this.$element().addClass("dx-scrollable"),e=this._$container=n("<div>").addClass("dx-scrollable-container"),i=this._$wrapper=n("<div>").addClass("dx-scrollable-wrapper"),s=this._$content=n("<div>").addClass("dx-scrollable-content");p.hasDocumentProperty("onbeforeactivate")&&a.msie&&a.version<12&&o.on(t,m.addNamespace("beforeactivate",D),(function(t){n(t.target).is(v.focusable)||t.preventDefault()})),s.append(t.contents()).appendTo(e),e.appendTo(i),i.appendTo(t)},_dimensionChanged:function(){this.update()},_attachNativeScrollbarsCustomizationCss:function(){"desktop"!==f.real().deviceType||h.platform.indexOf("Mac")>-1&&a.webkit||this.$element().addClass("dx-scrollable-customizable-scrollbars")},_initMarkup:function(){this.callBase(),this._renderDirection()},_render:function(){this._renderStrategy(),this._attachNativeScrollbarsCustomizationCss(),this._attachEventHandlers(),this._renderDisabledState(),this._createActions(),this.update(),this.callBase(),this._updateRtlPosition()},_updateRtlPosition:function(){var t=this,e=t.option("rtlEnabled");this._updateBounds(),e&&this.option("direction")!==O&&l.deferUpdate((function(){var e=t.scrollWidth()-t.clientWidth();l.deferRender((function(){t.scrollTo({left:e})}))}))},_updateBounds:function(){this._strategy.updateBounds()},_attachEventHandlers:function(){var t=this._strategy,e={getDirection:t.getDirection.bind(t),validate:this._validate.bind(this),isNative:this.option("useNative"),scrollTarget:this._$container};o.off(this._$wrapper,"."+D),o.on(this._$wrapper,m.addNamespace(g.init,D),e,this._initHandler.bind(this)),o.on(this._$wrapper,m.addNamespace(g.start,D),t.handleStart.bind(t)),o.on(this._$wrapper,m.addNamespace(g.move,D),t.handleMove.bind(t)),o.on(this._$wrapper,m.addNamespace(g.end,D),t.handleEnd.bind(t)),o.on(this._$wrapper,m.addNamespace(g.cancel,D),t.handleCancel.bind(t)),o.on(this._$wrapper,m.addNamespace(g.stop,D),t.handleStop.bind(t)),o.off(this._$container,"."+D),o.on(this._$container,m.addNamespace("scroll",D),t.handleScroll.bind(t))},_validate:function(t){return!this._isLocked()&&(this._updateIfNeed(),this._strategy.validate(t))},_initHandler:function(){var t=this._strategy;t.handleInit.apply(t,arguments)},_renderDisabledState:function(){this.$element().toggleClass("dx-scrollable-disabled",this.option("disabled")),this.option("disabled")?this._lock():this._unlock()},_renderDirection:function(){this.$element().removeClass("dx-scrollable-horizontal").removeClass("dx-scrollable-vertical").removeClass("dx-scrollable-both").addClass("dx-scrollable-"+this.option("direction"))},_renderStrategy:function(){this._createStrategy(),this._strategy.render(),this.$element().data($,this._strategy)},_createStrategy:function(){this._strategy=this.option("useNative")?new y(this):new S.SimulatedStrategy(this)},_createActions:function(){this._strategy&&this._strategy.createActions()},_clean:function(){this._strategy&&this._strategy.dispose()},_optionChanged:function(t){switch(t.name){case"onStart":case"onEnd":case"onStop":case"onUpdated":case"onScroll":case"onBounce":this._createActions();break;case"direction":this._resetInactiveDirection(),this._invalidate();break;case"useNative":this._setUseSimulatedScrollbar(),this._invalidate();break;case"inertiaEnabled":case"scrollByContent":case"scrollByThumb":case"bounceEnabled":case"useKeyboard":case"showScrollbar":case"useSimulatedScrollbar":case"pushBackValue":this._invalidate();break;case"disabled":this._renderDisabledState(),this._strategy&&this._strategy.disabledChanged();break;case"updateManually":break;case"width":this.callBase(t),this._updateRtlPosition();break;default:this.callBase(t)}},_resetInactiveDirection:function(){var t=this._getInactiveProp();if(t&&u.hasWindow()){var e=this.scrollOffset();e[t]=0,this.scrollTo(e)}},_getInactiveProp:function(){var t=this.option("direction");return t===O?"left":t===E?"top":void 0},_location:function(){return this._strategy.location()},_normalizeLocation:function(t){if(r.isPlainObject(t)){var e=l.ensureDefined(t.left,t.x),i=l.ensureDefined(t.top,t.y);return{left:r.isDefined(e)?-e:void 0,top:r.isDefined(i)?-i:void 0}}var n=this.option("direction");return{left:n!==O?-t:void 0,top:n!==E?-t:void 0}},_isLocked:function(){return this._locked},_lock:function(){this._locked=!0},_unlock:function(){this.option("disabled")||(this._locked=!1)},_isDirection:function(t){var e=this.option("direction");return t===O?e!==E:t===E?e!==O:e===t},_updateAllowedDirection:function(){var t=this._strategy._allowedDirections();this._isDirection(P)&&t.vertical&&t.horizontal?this._allowedDirectionValue=P:this._isDirection(E)&&t.horizontal?this._allowedDirectionValue=E:this._isDirection(O)&&t.vertical?this._allowedDirectionValue=O:this._allowedDirectionValue=null},_allowedDirection:function(){return this._allowedDirectionValue},_container:function(){return this._$container},$content:function(){return this._$content},content:function(){return d(this._$content)},scrollOffset:function(){var t=this._location();return{top:-t.top,left:-t.left}},scrollTop:function(){return this.scrollOffset().top},scrollLeft:function(){return this.scrollOffset().left},clientHeight:function(){return this._$container.height()},scrollHeight:function(){return this.$content().outerHeight()-2*this._strategy.verticalOffset()},clientWidth:function(){return this._$container.width()},scrollWidth:function(){return this.$content().outerWidth()},update:function(){if(this._strategy)return w(this._strategy.update()).done(function(){this._updateAllowedDirection()}.bind(this))},scrollBy:function(t){((t=this._normalizeLocation(t)).top||t.left)&&(this._updateIfNeed(),this._strategy.scrollBy(t))},scrollTo:function(t){t=this._normalizeLocation(t),this._updateIfNeed();var e=this._location();this.option("useNative")||(t=this._strategy._applyScaleRatio(t),e=this._strategy._applyScaleRatio(e));var i=this._normalizeLocation({left:e.left-l.ensureDefined(t.left,e.left),top:e.top-l.ensureDefined(t.top,e.top)});(i.top||i.left)&&this._strategy.scrollBy(i)},scrollToElement:function(t,e){e=e||{};var i=n(t),o=this.$content().find(t).length,s=i.parents(".dx-scrollable").length-i.parents(".dx-scrollable-content").length==0;if(o&&s){var a={top:0,left:0},l=this.option("direction");l!==O&&(a.left=this._scrollToElementPosition(i,E,e)),l!==E&&(a.top=this._scrollToElementPosition(i,O,e)),this.scrollTo(a)}},_scrollToElementPosition:function(t,e,i){var n=e===O,o=(n?i.top:i.left)||0,s=(n?i.bottom:i.right)||0,a=n?this._strategy.verticalOffset():0,l,r=this._elementPositionRelativeToContent(t,n?"top":"left")-a,c=t[n?"outerHeight":"outerWidth"](),d=n?this.scrollTop():this.scrollLeft(),u,h=d-r+o,p=d-r-c+(n?this.clientHeight():this.clientWidth())-s;return h<=0&&p>=0?d:d-(Math.abs(h)>Math.abs(p)?p:h)},_elementPositionRelativeToContent:function(t,e){for(var i=0;this._hasScrollContent(t);)i+=t.position()[e],t=t.offsetParent();return i},_hasScrollContent:function(t){var e=this.$content();return t.closest(e).length&&!t.is(e)},_updateIfNeed:function(){this.option("updateManually")||this.update()}});_(D,H),i.exports=H,i.exports.deviceDependentOptions=z}

