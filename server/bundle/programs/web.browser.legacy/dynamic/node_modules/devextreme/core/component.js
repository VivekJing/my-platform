function module(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function s(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=t("./config"),p=t("./dom_adapter"),c=t("./utils/extend").extend,u=t("./class"),l=t("./action"),d=t("./errors"),h=t("./utils/data"),f=t("./utils/common"),_=t("./utils/type"),g=t("../core/utils/deferred"),O=g.Deferred,v=g.when,y=t("./utils/callbacks"),m=t("./events_mixin"),b=t("./utils/public_component"),C=t("./devices"),A=_.isFunction,D=f.noop,E={},k={},B=function(){function t(){r(this,t),this._postponedOperations={}}return o(t,[{key:"add",value:function(t,e,i){if(t in this._postponedOperations)i&&this._postponedOperations[t].promises.push(i);else{var n=new O;this._postponedOperations[t]={fn:e,completePromise:n,promises:i?[i]:[]}}return this._postponedOperations[t].completePromise.promise()}},{key:"callPostponedOperations",value:function(){for(var t in this._postponedOperations){var e=this._postponedOperations[t];_.isDefined(e)&&(e.promises&&e.promises.length?v.apply(void 0,s(e.promises)).done(e.fn).then(e.completePromise.resolve):e.fn().done(e.completePromise.resolve))}this._postponedOperations={}}}]),t}(),x=u.inherit({_setDeprecatedOptions:function(){this._deprecatedOptions={}},_getDeprecatedOptions:function(){return this._deprecatedOptions},_getOptionAliasesByName:function(t){var e=this;return Object.keys(this._deprecatedOptions).filter((function(i){return t===e._deprecatedOptions[i].alias}))},_getDefaultOptions:function(){return{onInitialized:null,onOptionChanged:null,onDisposing:null,defaultOptionsRules:null}},_setDefaultOptions:function(){this._options=this._getDefaultOptions()},_defaultOptionsRules:function(){return[]},_setOptionsByDevice:function(t){var e=this._defaultOptionsRules();Array.isArray(t)&&(e=e.concat(t));var i=this._convertRulesToOptions(e);for(var n in c(!0,this._options,i),this._optionsByReference)i.hasOwnProperty(n)&&(this._options[n]=i[n])},_convertRulesToOptions:function(t){for(var e={},i=C.current(),n=function(t,e){var i=[];return Array.prototype.push.call(i,e),1===i.length&&_.isEmptyObject(i[0])||f.findBestMatches(t,i).length>0},o=0;o<t.length;o++){var s,r=t[o],a=r.device||{};(s=A(a)?a(i):n(i,a))&&c(e,r.options)}return e},_isInitialOptionValue:function(t){var e=this.option(t),i=this.initialOption(t),n;return A(e)&&A(i)?e.toString()===i.toString():f.equalByValue(e,i)},_setOptionsByReference:function(){this._optionsByReference={}},_getOptionsByReference:function(){return this._optionsByReference},ctor:function(t){this.NAME=b.name(this.constructor),(t=t||{}).eventsStrategy&&this.setEventsStrategy(t.eventsStrategy),this._options={},this._updateLockCount=0,this._optionChangedCallbacks=t._optionChangedCallbacks||y(),this._disposingCallbacks=t._disposingCallbacks||y(),this.postponedOperations=new B,this.beginUpdate();try{this._suppressDeprecatedWarnings(),this._setOptionsByReference(),this._setDeprecatedOptions(),this._setDefaultOptions(),t&&t.onInitializing&&t.onInitializing.apply(this,[t]),this._setOptionsByDevice(t.defaultOptionsRules),this._resumeDeprecatedWarnings(),this._initOptions(t)}finally{this.endUpdate()}},_initOptions:function(t){this.option(t)},_optionValuesEqual:function(t,e,i){return e=h.toComparable(e,!0),i=h.toComparable(i,!0),e&&i&&_.isRenderer(e)&&_.isRenderer(i)?i.is(e):!(e==e||i==i)||!(null!==e&&"object"===(void 0===e?"undefined":n(e))&&!p.isElementNode(e))&&e===i;var o,s},_init:function(){this._createOptionChangedAction(),this.on("disposing",function(t){this._disposingCallbacks.fireWith(this,[t])}.bind(this))},_createOptionChangedAction:function(){this._optionChangedAction=this._createActionByOption("onOptionChanged",{excludeValidators:["disabled","readOnly","designMode"]})},_createDisposingAction:function(){this._disposingAction=this._createActionByOption("onDisposing",{excludeValidators:["disabled","readOnly","designMode"]})},_optionChanged:function(t){switch(t.name){case"onDisposing":case"onInitialized":break;case"onOptionChanged":this._createOptionChangedAction()}},_dispose:function(){this._optionChangedCallbacks.empty(),this._createDisposingAction(),this._disposingAction(),this._disposeEvents(),this._disposed=!0},instance:function(){return this},beginUpdate:function(){this._updateLockCount++},endUpdate:function(){if(this._updateLockCount=Math.max(this._updateLockCount-1,0),!this._updateLockCount&&(this.postponedOperations.callPostponedOperations(),!this._initializing&&!this._initialized)){this._initializing=!0;try{this._init()}finally{this._initializing=!1,this._updateLockCount++,this._createActionByOption("onInitialized",{excludeValidators:["disabled","readOnly","designMode"]})(),this._updateLockCount--,this._initialized=!0}}},_logWarningIfDeprecated:function(t){var e=this._deprecatedOptions[t];e&&!this._deprecatedOptionsSuppressed&&this._logDeprecatedWarning(t,e)},_logDeprecatedWarningCount:0,_logDeprecatedWarning:function(t,e){var i=e.message||"Use the '"+e.alias+"' option instead";d.log("W0001",this.NAME,t,e.since,i),++this._logDeprecatedWarningCount},_suppressDeprecatedWarnings:function(){this._deprecatedOptionsSuppressed=!0},_resumeDeprecatedWarnings:function(){this._deprecatedOptionsSuppressed=!1},_optionChanging:D,_notifyOptionChanged:function(t,e,i){var n=this;if(this._initialized)for(var o=[t].concat(this._getOptionAliasesByName(t)),s=0;s<o.length;s++){var r=o[s],a={name:r.split(/[.[]/)[0],fullName:r,value:e,previousValue:i};this._optionChangedCallbacks.fireWith(this,[c(this._defaultActionArgs(),a)]),this._optionChangedAction(c({},a)),this._disposed||this._cancelOptionChange===a.name||this._optionChanged(a)}},initialOption:function(t){var e,i=this._initialized;return this._initialOptions||(e=this._options,this._options={},this._initialized=!1,this._setDefaultOptions(),this._setOptionsByDevice(e.defaultOptionsRules),this._initialOptions=this._options,this._options=e,this._initialized=i),this._initialOptions[t]},_defaultActionConfig:function(){return{context:this,component:this}},_defaultActionArgs:function(){return{component:this}},_createAction:function(t,e){var i,n=this;return function(o){return arguments.length||(o={}),_.isPlainObject(o)||(o={actionValue:o}),(i=i||new l(t,c(e,n._defaultActionConfig()))).execute.call(i,c(o,n._defaultActionArgs()))}},_createActionByOption:function(t,e){var i,n,o,s=this,r=function(){if(!n){if(e=e||{},"string"!=typeof t)throw d.Error("E0008");0===t.indexOf("on")&&(n=s._getEventName(t)),o=s.option(t)}if(i||o||e.beforeExecute||e.afterExecute||s.hasEvent(n)){if(!i){var r=e.beforeExecute;e.beforeExecute=function(t){r&&r.apply(s,arguments),s.fireEvent(n,t.args)},s._suppressDeprecatedWarnings(),i=s._createAction(o,e),s._resumeDeprecatedWarnings()}if(a().wrapActionsBeforeExecute){var p=s.option("beforeActionExecute")||D,c=p(s,i,e)||i;return c.apply(s,arguments)}return i.apply(s,arguments)}},p;a().wrapActionsBeforeExecute||(r=(s.option("onActionCreated")||D)(s,r,e)||r);return r},_getEventName:function(t){return t.charAt(2).toLowerCase()+t.substr(3)},hasActionSubscription:function(t){return!!this.option(t)||this.hasEvent(this._getEventName(t))},isOptionDeprecated:function(t){var e;return this._getDeprecatedOptions().hasOwnProperty(t)},_setOptionSilent:function(t,e){this._cancelOptionChange=t,this.option(t,e),this._cancelOptionChange=!1},option:(w=function(t,e){var i;if(e){if(!t._cachedDeprecateNames)for(var n in t._cachedDeprecateNames=[],t._deprecatedOptions)t._cachedDeprecateNames.push(n);for(var o=0;o<t._cachedDeprecateNames.length;o++)if(t._cachedDeprecateNames[o]===e){i=t._deprecatedOptions[e];break}if(i){t._logWarningIfDeprecated(e);var s=i.alias;s&&(e=s)}}return e},R=function(t){var e=t.split(".");return e.pop(),e.join(".")},S=function(t){var e=t.split(".");return e[e.length-1]},z=function(t,e,i){var n=E[e];return n||(n=E[e]=h.compileGetter(e)),n(t,{functionsAsIs:!0,unwrapObservables:i})},W=function(t,e){delete t[e];var i=R(e),n=S(e),o=i?z(t,i,!1):t;o&&delete o[n]},N=function(t,e,i){var n,o="";do{o&&(o="."+o),o=S(e)+o,n=(e=R(e))?z(t,e,!1):t}while(!n);n[o]=i},P=function(t,e,i,n){if(i){var o=w(t,i);o&&o!==i&&(N(e,o,n),W(e,i))}},I=function t(e,i,n,o){if(_.isPlainObject(o))for(var s in o)t(e,i,n+"."+s,o[s]);P(e,i,n,o)},V=function(t,e,i){k[e]||(k[e]=h.compileSetter(e));var n=e.split(/[.[]/);k[e](t._options,i,{functionsAsIs:!0,merge:!t._getOptionsByReference()[e],unwrapObservables:n.length>1&&!!t._getOptionsByReference()[n[0]]})},j=function(t,e,i){var n=z(t._options,e,!1);t._optionValuesEqual(e,n,i)||(t._initialized&&t._optionChanging(e,n,i),V(t,e,i),t._notifyOptionChanged(e,i,n))},function(t,e){var i=this,n=t;if(arguments.length<2&&"object"!==_.type(n))return n=w(i,n),z(i._options,n);"string"==typeof n&&((t={})[n]=e),i.beginUpdate();try{var o;for(o in t)I(i,t,o,t[o]);for(o in t)j(i,o,t[o])}finally{i.endUpdate()}}),_getOptionValue:function(t,e){var i=this.option(t);return A(i)?i.bind(e)():i}}).include(m),w,R,S,z,W,N,P,I,V,j;i.exports=x,i.exports.PostponedOperations=B}

